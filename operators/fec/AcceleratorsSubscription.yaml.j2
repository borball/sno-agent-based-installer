{% set default_source='certified-operators' -%}
{% set catsrc = customs|selectattr('provide', '==', default_source)|map(attribute='name')|list -%}
{% if catsrc -%}
{% set default_source=catsrc[0] -%}
{% endif -%}
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: sriov-fec-subscription
  namespace: vran-acceleration-operators
spec:
  channel: stable
  name: sriov-fec
  source: {{ source | default(default_source) }}
  sourceNamespace: openshift-marketplace
  {% if version is defined and version is not none -%}
  startingCSV: {{ version }}
  installPlanApproval: Manual
  {% else -%}
  installPlanApproval: Automatic
  {%- endif %}
